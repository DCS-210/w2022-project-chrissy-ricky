---
title: "data analysis"
author: "Chrissy & Ricky"
date: '`r Sys.Date()`'
output: html_document
---

```{r load-packages, message = FALSE}
library(tidyverse) ## For plotting and data wrangling.
library(readr)
library(broom)
library(fivethirtyeight)
library(WDI)
library(rgdal)
library(leaflet) ## For leaflet interactive maps
library(sf) ## For spatial data
library(RColorBrewer) ## For colour palettes
library(htmltools) ## For html
library(leafsync) ## For placing plots side by side
library(kableExtra) ## Table  output (in slides)
```

```{r import_data}
covid_data <- readr::read_csv(file = "../data/owid-covid-data.csv")
covid_data_codebook <- readr::read_csv(file = "../data/owid-covid-codebook.csv")
```

## Data Cleaning and Manipulation

The data is from 2020-02-24 to 2022-02-24
```{r data-cleaning, include=FALSE}
covid_total <- covid_data %>%
  filter(date == "2022-02-24")

covid_country <- covid_total %>%
  filter(is.na(continent) == FALSE)

covid_other <- covid_total %>%
  filter(is.na(continent) == TRUE)
```

```{r create-variables}
covid_country <- covid_country %>%
  mutate(percentage_cases = total_cases/population,
         percentage_deaths = total_deaths/population,
         percentage_vaccination = people_fully_vaccinated/population,
         percentage_booster = total_boosters/population)
covid_country     
```

## Create subsets of data

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Preliminary data analysis

```{r}
library(rgdal)
my_spdf <- readOGR( 
  dsn = paste0(getwd(),"/DATA/world_shape_file/") , 
  layer = "TM_WORLD_BORDERS-0.3",
  verbose = FALSE
)
```

```{r maps}
world_df <- st_read(system.file("data/world_shape_file/TM_WORLD_BORDERS-0.3.shp", package="sf"))
```

```{r}

```

## Statistical analyses and regressions

```{r linear-models}
linear_reg() %>%
  set_engine("lm") %>%
  fit(total_cases_per_million ~ population_density + hospital_beds_per_thousand, data = covid_country) %>%
  tidy()
```

## More advanced models and machine learning

```{r}

```




